---
title: "[카카오 로그인] 토큰(Token)에 관한 글"
description: 로그인 인증 방식에 대해 공부한 내용을 정리합니다.
author: melonhong
date: '2025-11-22 23:23:03 +0900'
categories:
- rooton
tags: []
---
## 개요

현재 서비스는 **이메일 로그인**과 **카카오 로그인** 구조가 나뉘어 있습니다.

  * **이메일 로그인:** Access Token(AT)과 Refresh Token(RT)을 생성하고, **RT는 DB에 저장**
  * **카카오 로그인:** AT와 RT를 생성하지만, **RT를 DB에 저장하지 않음** (→ RT를 DB에 저장하도록 수정)


-----

## 로그인 인증

인증이 필요할 때마다 아이디와 패스워드를 입력하는 방식은 **서버 부하 증가**와 **사용자 불편**이라는 문제가 있습니다. 이를 해결하기 위해 로그인 시 서버로부터 토큰이나 세션을 받아 사용자를 기억하고, 다음 요청부터는 이를 통해 \*\*인증(Authentication)\*\*과 \*\*인가(Authorization)\*\*를 수행합니다.

로그인 인증 방식에는 **세션 기반**과 **토큰 기반**이 있습니다.

-----

## 세션 기반 인증

**세션(session):** 클라이언트가 서버에 접속해 있는 하나의 상태.

이는 서버에 클라이언트의 상태를 저장하는 **Stateful**한 방식입니다.

1.  클라이언트가 서버에 로그인합니다.
2.  서버가 세션을 생성하고 키(세션 id)-값(민감한 정보)을 서버 메모리에 저장합니다.
3.  서버가 브라우저에 **세션 id**를 저장합니다.
4.  클라이언트가 요청 시 세션 id를 함께 전송합니다.
5.  서버는 세션 id를 검사하여 세션의 유효성을 확인한 뒤 요청을 수행합니다.

<!-- end list -->

  * **장점:** 세션 id 유출 시에도 개인정보 유출 위험이 적음, 구현 용이, 보안 우수
  * **단점:** 인증 시 서버 부하 증가, 세션 id 탈취 시 해킹 위험

-----

## 토큰 인증 방식

**토큰(token):** 사용자의 인증 상태를 확인하는 데 사용되는 임시 저장 값.

이는 서버에 클라이언트의 상태를 저장하지 않는 **Stateless**한 방식입니다. 서버는 시크릿 키로 암호화된 토큰을 클라이언트에게 지급하고, 클라이언트가 요청 시 토큰을 보내면 서버가 시크릿 키로 복호화하여 검증합니다.

1.  클라이언트가 서버에 로그인합니다.
2.  서버가 클라이언트 정보를 시크릿 키로 암호화한 **토큰**을 지급합니다.
3.  클라이언트는 토큰을 저장하고 있다가 요청 시 헤더에 포함시켜 전달합니다.
4.  서버가 시크릿 키로 토큰을 복호화하여 검증합니다.

<!-- end list -->

  * **장점:** 서버 메모리에 접근하지 않아 서버 부하 감소, Stateless 방식으로 **확장성** 우수
  * **단점:** 토큰 탈취에 취약, 토큰 길이가 길어 네트워크 부하 발생 가능

-----

## JWT (Json Web Token)

JWT는 JSON 객체 형태로 데이터를 안전하게 전송하는 개방형 표준입니다. JSON 데이터를 Base64 URL-safe Encode로 인코딩하여 직렬화하여 만듭니다.

JWT는 `xxxxx.yyyyy.zzzzz`와 같이 **헤더**, **페이로드**, **시그니처** 세 부분으로 나뉩니다.

### 1\. 헤더 (`xxxxx`)

토큰 유형(`typ`: JWT)과 사용되는 서명 알고리즘(`alg`: HS256 등)으로 구성됩니다.

```json
{
  "alg": "HS256",
  "typ": "JWT"
}
```

### 2\. 페이로드 (`yyyyy`)

클라이언트 정보나 추가적인 데이터를 담는 부분입니다. 키-값 쌍의 정보를 \*\*클레임(claim)\*\*이라고 합니다.

  * **Registered claims:** 토큰의 주체 정보 (ex: `iss`, `exp`, `sub`, `aud`)
  * **Public claims:** 임의로 정의하여 사용 (ex: `name`, `email`)
  * **Private claims:** 토큰을 주고받는 당사자끼리 사용 (ex: `admin`, `role`)

<!-- end list -->

```json
{
  "sub": "1234567890",
  "name": "John Doe",
  "admin": true
}
```

### 3\. 시그니처 (`zzzzz`)

**헤더** + **페이로드** + **서버의 시크릿 키**를 합치고 헤더에서 정의한 알고리즘으로 암호화한 부분입니다. 메시지가 전달되는 도중에 **변조되지 않았음**을 증명합니다.

-----

## Access Token(AT)과 Refresh Token(RT)

  * **Access Token (AT):** 클라이언트가 서버에 접근할 수 있도록 하는 **단기 자격 증명**.
  * **Refresh Token (RT):** 새로운 Access Token을 발급받기 위해 사용되는 **장기 자격 증명**.

AT가 필요한 이유는 JWT는 발급 후 삭제가 불가능하고 토큰만 있으면 누구나 인증을 받을 수 있어 보안에 취약하기 때문입니다. 따라서 **AT의 만료 시간을 짧게** 설정하여 탈취 시 위험을 줄입니다.

하지만 만료 시간을 짧게 하면 클라이언트가 로그인을 자주 해야 하는 불편함이 생기므로, **RT를 사용하여 AT가 만료될 때마다 새로운 AT를 발급**받아 편의성과 보안성을 모두 확보합니다.

-----

## AT와 RT의 전달 위치

  * **XSS (Cross-Site Scripting):** 악성 JavaScript로 쿠키/개인 정보 탈취 공격.
  * **CSRF (Cross-Site Request Forgery):** 로그인된 사용자의 권한으로 임의의 동작을 수행하는 공격.

많은 서비스가 이용하는 일반적인 방식:

  * **AT:** **HTTP Authorization 헤더**에 담아 전송 (OAuth 2.0 권고 사항).
  * **RT:** **HttpOnly 쿠키**에 담아 전송 (XSS 공격 방어, `Strict SameSite` 속성 등으로 CSRF 대응 가능).

RT를 HttpOnly 쿠키에 담으면 브라우저가 자동으로 전송해주므로 편리하며, AT를 헤더에 담는 방식이 OAuth 2.0 표준을 따릅니다.

-----

## 원글

[[카카오 로그인] 토큰(Token)에 관한 글](https://readinging.tistory.com/8)